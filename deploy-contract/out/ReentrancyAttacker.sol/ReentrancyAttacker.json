{"abi":[{"type":"constructor","inputs":[{"name":"_target","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"fallback","stateMutability":"payable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"MAX_ATTACKS","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"attack","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"attackCount","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"target","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract ISecureAssetManager"}],"stateMutability":"view"},{"type":"event","name":"AttackAttempt","inputs":[{"name":"count","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false}],"bytecode":{"object":"0x608060405234801561000f575f80fd5b5060405161053738038061053783398101604081905261002e9161005b565b5f80546001600160a01b039092166001600160a01b03199283161790556001805490911633179055610088565b5f6020828403121561006b575f80fd5b81516001600160a01b0381168114610081575f80fd5b9392505050565b6104a2806100955f395ff3fe60806040526004361061004d575f3560e01c8063407c2821146101df5780638da5cb5b146102075780639e5faafc1461023e578063b36303fe14610252578063d4b839921461026657610199565b366101995760028054905f6100618361040b565b91905055507f2496e2dc115746cf9714d1bf354fad6f978bcc9ddeae18b73c6af7e03ef7e3d560025460405161009991815260200190565b60405180910390a160056002541015610197575f80546040516370a0823160e01b81523060048201526001600160a01b03909116906370a0823190602401602060405180830381865afa1580156100f2573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610116919061042f565b90508015610195575f5460015460405163a9059cbb60e01b81526001600160a01b0391821660048201526024810184905291169063a9059cbb906044016020604051808303815f875af115801561016f573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101939190610446565b505b505b005b60405162461bcd60e51b815260206004820152601660248201527511985b1b189858dac81b9bdd081cdd5c1c1bdc9d195960521b60448201526064015b60405180910390fd5b3480156101ea575f80fd5b506101f460025481565b6040519081526020015b60405180910390f35b348015610212575f80fd5b50600154610226906001600160a01b031681565b6040516001600160a01b0390911681526020016101fe565b348015610249575f80fd5b50610197610284565b34801561025d575f80fd5b506101f4600581565b348015610271575f80fd5b505f54610226906001600160a01b031681565b6001546001600160a01b031633146102d65760405162461bcd60e51b81526020600482015260156024820152744f6e6c79206f776e65722063616e2061747461636b60581b60448201526064016101d6565b5f80546040516370a0823160e01b81523060048201526001600160a01b03909116906370a0823190602401602060405180830381865afa15801561031c573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610340919061042f565b90505f81116103915760405162461bcd60e51b815260206004820152601960248201527f4e6f2062616c616e636520746f2061747461636b20776974680000000000000060448201526064016101d6565b5f60028190555460405163a9059cbb60e01b8152306004820152602481018390526001600160a01b039091169063a9059cbb906044016020604051808303815f875af11580156103e3573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104079190610446565b5050565b5f6001820161042857634e487b7160e01b5f52601160045260245ffd5b5060010190565b5f6020828403121561043f575f80fd5b5051919050565b5f60208284031215610456575f80fd5b81518015158114610465575f80fd5b939250505056fea2646970667358221220683e971dd4de5b3438df402dafe59453b1af67038989bd358e9e0137ae14d90b64736f6c63430008140033","sourceMap":"400:1522:10:-:0;;;618:111;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;657:6;:37;;-1:-1:-1;;;;;657:37:10;;;-1:-1:-1;;;;;;657:37:10;;;;;;;704:18;;;;;712:10;704:18;;;400:1522;;14:290:38;84:6;137:2;125:9;116:7;112:23;108:32;105:52;;;153:1;150;143:12;105:52;179:16;;-1:-1:-1;;;;;224:31:38;;214:42;;204:70;;270:1;267;260:12;204:70;293:5;14:290;-1:-1:-1;;;14:290:38:o;:::-;400:1522:10;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x60806040526004361061004d575f3560e01c8063407c2821146101df5780638da5cb5b146102075780639e5faafc1461023e578063b36303fe14610252578063d4b839921461026657610199565b366101995760028054905f6100618361040b565b91905055507f2496e2dc115746cf9714d1bf354fad6f978bcc9ddeae18b73c6af7e03ef7e3d560025460405161009991815260200190565b60405180910390a160056002541015610197575f80546040516370a0823160e01b81523060048201526001600160a01b03909116906370a0823190602401602060405180830381865afa1580156100f2573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610116919061042f565b90508015610195575f5460015460405163a9059cbb60e01b81526001600160a01b0391821660048201526024810184905291169063a9059cbb906044016020604051808303815f875af115801561016f573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101939190610446565b505b505b005b60405162461bcd60e51b815260206004820152601660248201527511985b1b189858dac81b9bdd081cdd5c1c1bdc9d195960521b60448201526064015b60405180910390fd5b3480156101ea575f80fd5b506101f460025481565b6040519081526020015b60405180910390f35b348015610212575f80fd5b50600154610226906001600160a01b031681565b6040516001600160a01b0390911681526020016101fe565b348015610249575f80fd5b50610197610284565b34801561025d575f80fd5b506101f4600581565b348015610271575f80fd5b505f54610226906001600160a01b031681565b6001546001600160a01b031633146102d65760405162461bcd60e51b81526020600482015260156024820152744f6e6c79206f776e65722063616e2061747461636b60581b60448201526064016101d6565b5f80546040516370a0823160e01b81523060048201526001600160a01b03909116906370a0823190602401602060405180830381865afa15801561031c573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610340919061042f565b90505f81116103915760405162461bcd60e51b815260206004820152601960248201527f4e6f2062616c616e636520746f2061747461636b20776974680000000000000060448201526064016101d6565b5f60028190555460405163a9059cbb60e01b8152306004820152602481018390526001600160a01b039091169063a9059cbb906044016020604051808303815f875af11580156103e3573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104079190610446565b5050565b5f6001820161042857634e487b7160e01b5f52601160045260245ffd5b5060010190565b5f6020828403121561043f575f80fd5b5051919050565b5f60208284031215610456575f80fd5b81518015158114610465575f80fd5b939250505056fea2646970667358221220683e971dd4de5b3438df402dafe59453b1af67038989bd358e9e0137ae14d90b64736f6c63430008140033","sourceMap":"400:1522:10:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1446:11;:13;;;:11;:13;;;:::i;:::-;;;;;;1474:26;1488:11;;1474:26;;;;397:25:38;;385:2;370:18;;251:177;1474:26:10;;;;;;;;569:1;1515:11;;:25;1511:274;;;1556:15;1574:6;;:31;;-1:-1:-1;;;1574:31:10;;1599:4;1574:31;;;579:51:38;-1:-1:-1;;;;;1574:6:10;;;;:16;;552:18:38;;1574:31:10;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1556:49;-1:-1:-1;1623:11:10;;1619:156;;1729:6;;;1745:5;1729:31;;-1:-1:-1;;;1729:31:10;;-1:-1:-1;;;;;1745:5:10;;;1729:31;;;1004:51:38;1071:18;;;1064:34;;;1729:6:10;;;:15;;977:18:38;;1729:31:10;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;1619:156;1542:243;1511:274;400:1522;;1881:32;;-1:-1:-1;;;1881:32:10;;1593:2:38;1881:32:10;;;1575:21:38;1632:2;1612:18;;;1605:30;-1:-1:-1;;;1651:18:38;;;1644:52;1713:18;;1881:32:10;;;;;;;;499:26;;;;;;;;;;;;;;;;;;;397:25:38;;;385:2;370:18;499:26:10;;;;;;;;473:20;;;;;;;;;;-1:-1:-1;473:20:10;;;;-1:-1:-1;;;;;473:20:10;;;;;;-1:-1:-1;;;;;597:32:38;;;579:51;;567:2;552:18;473:20:10;433:203:38;795:406:10;;;;;;;;;;;;;:::i;531:39::-;;;;;;;;;;;;569:1;531:39;;434:33;;;;;;;;;;-1:-1:-1;434:33:10;;;;-1:-1:-1;;;;;434:33:10;;;795:406;854:5;;-1:-1:-1;;;;;854:5:10;840:10;:19;832:53;;;;-1:-1:-1;;;832:53:10;;2180:2:38;832:53:10;;;2162:21:38;2219:2;2199:18;;;2192:30;-1:-1:-1;;;2238:18:38;;;2231:51;2299:18;;832:53:10;1978:345:38;832:53:10;904:15;922:6;;:31;;-1:-1:-1;;;922:31:10;;947:4;922:31;;;579:51:38;-1:-1:-1;;;;;922:6:10;;;;:16;;552:18:38;;922:31:10;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;904:49;;981:1;971:7;:11;963:49;;;;-1:-1:-1;;;963:49:10;;2530:2:38;963:49:10;;;2512:21:38;2569:2;2549:18;;;2542:30;2608:27;2588:18;;;2581:55;2653:18;;963:49:10;2328:349:38;963:49:10;1037:1;1023:11;:15;;;1155:6;:39;;-1:-1:-1;;;1155:39:10;;1179:4;1155:39;;;1004:51:38;1071:18;;;1064:34;;;-1:-1:-1;;;;;1155:6:10;;;;:15;;977:18:38;;1155:39:10;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;822:379;795:406::o;14:232:38:-;53:3;74:17;;;71:140;;133:10;128:3;124:20;121:1;114:31;168:4;165:1;158:15;196:4;193:1;186:15;71:140;-1:-1:-1;238:1:38;227:13;;14:232::o;641:184::-;711:6;764:2;752:9;743:7;739:23;735:32;732:52;;;780:1;777;770:12;732:52;-1:-1:-1;803:16:38;;641:184;-1:-1:-1;641:184:38:o;1109:277::-;1176:6;1229:2;1217:9;1208:7;1204:23;1200:32;1197:52;;;1245:1;1242;1235:12;1197:52;1277:9;1271:16;1330:5;1323:13;1316:21;1309:5;1306:32;1296:60;;1352:1;1349;1342:12;1296:60;1375:5;1109:277;-1:-1:-1;;;1109:277:38:o","linkReferences":{}},"methodIdentifiers":{"MAX_ATTACKS()":"b36303fe","attack()":"9e5faafc","attackCount()":"407c2821","owner()":"8da5cb5b","target()":"d4b83992"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.20+commit.a1b79de6\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_target\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"count\",\"type\":\"uint256\"}],\"name\":\"AttackAttempt\",\"type\":\"event\"},{\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"inputs\":[],\"name\":\"MAX_ATTACKS\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"attackCount\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"target\",\"outputs\":[{\"internalType\":\"contract ISecureAssetManager\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"details\":\"Malicious contract to test reentrancy guard\",\"kind\":\"dev\",\"methods\":{\"attack()\":{\"details\":\"Initiates the reentrancy attack\"}},\"title\":\"ReentrancyAttacker\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"notice\":\"This contract attempts to exploit reentrancy vulnerability\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/ReentrancyAttacker.sol\":\"ReentrancyAttacker\"},\"evmVersion\":\"shanghai\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":@openzeppelin/=node_modules/@openzeppelin/\",\":forge-std/=lib/forge-std/src/\",\":hardhat/=node_modules/hardhat/\"]},\"sources\":{\"contracts/ReentrancyAttacker.sol\":{\"keccak256\":\"0xa7b1f9c32d88c1b301fe03e11cdb2714cde7d71345bebaee87aa2b96fe4097ef\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://ee253560284370b4da63d468f0397b66e268c4dbab7abcd0776021d3a45f7d80\",\"dweb:/ipfs/QmWW46qGyhuGqffYfDmdijxZFv8q2iADkAN3bdmAiFArSr\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.20+commit.a1b79de6"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_target","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"uint256","name":"count","type":"uint256","indexed":false}],"type":"event","name":"AttackAttempt","anonymous":false},{"inputs":[],"stateMutability":"payable","type":"fallback"},{"inputs":[],"stateMutability":"view","type":"function","name":"MAX_ATTACKS","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"attack"},{"inputs":[],"stateMutability":"view","type":"function","name":"attackCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"target","outputs":[{"internalType":"contract ISecureAssetManager","name":"","type":"address"}]},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{"attack()":{"details":"Initiates the reentrancy attack"}},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["@openzeppelin/=node_modules/@openzeppelin/","forge-std/=lib/forge-std/src/","hardhat/=node_modules/hardhat/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"contracts/ReentrancyAttacker.sol":"ReentrancyAttacker"},"evmVersion":"shanghai","libraries":{}},"sources":{"contracts/ReentrancyAttacker.sol":{"keccak256":"0xa7b1f9c32d88c1b301fe03e11cdb2714cde7d71345bebaee87aa2b96fe4097ef","urls":["bzz-raw://ee253560284370b4da63d468f0397b66e268c4dbab7abcd0776021d3a45f7d80","dweb:/ipfs/QmWW46qGyhuGqffYfDmdijxZFv8q2iADkAN3bdmAiFArSr"],"license":"MIT"}},"version":1},"id":10}